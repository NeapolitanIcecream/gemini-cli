# CLI 命令

Gemini CLI 支持多个内置命令，帮助你管理会话、自定义界面以及控制其行为。这些命令以斜杠 (`/`)、at 符号 (`@`) 或感叹号 (`!`) 作为前缀。

## 斜杠命令 (`/`)

斜杠命令用于对 CLI 本身进行元级别的控制。

- **`/bug`**

  - **描述：** 为 Gemini CLI 报告问题。默认情况下，问题会创建在 Gemini CLI 的 GitHub 仓库中。你在 `/bug` 后输入的字符串将成为 bug 标题。可通过 `.gemini/settings.json` 中的 `bugCommand` 设置修改默认行为。

- **`/chat`**

  - **描述：** 交互式保存与恢复对话历史，用于分支会话状态或在之后的会话中恢复。
  - **子命令：**
    - **`save`**
      - **描述：** 保存当前对话历史，你必须提供 `<tag>` 用于标识会话状态。
      - **用法：** `/chat save <tag>`
    - **`resume`**
      - **描述：** 从先前保存的状态恢复对话。
      - **用法：** `/chat resume <tag>`
    - **`list`**
      - **描述：** 列出可用的会话标签。

- **`/clear`**

  - **描述：** 清除终端屏幕，包括可见的会话历史及滚动缓冲。底层会话数据（用于历史回溯）可能会被保留，具体取决于实现，但视觉展示会被清除。
  - **快捷键：** 任意时间按 **Ctrl+L** 以执行清屏。

- **`/compress`**

  - **描述：** 使用摘要替换整个聊天上下文。这可以节省后续任务所需的令牌，同时保留对已发生内容的高级概括。

- **`/editor`**

  - **描述：** 打开编辑器选择对话框，选择受支持的编辑器。

- **`/help`**（或 **`/?`**）

  - **描述：** 显示 Gemini CLI 的帮助信息，包括可用命令及其用法。

- **`/mcp`**

  - **描述：** 列出已配置的 Model Context Protocol (MCP) 服务器，其连接状态、服务器详情以及可用工具。
  - **子命令：**
    - **`desc`** 或 **`descriptions`**：
      - **描述：** 显示 MCP 服务器和工具的详细描述。
    - **`nodesc`** 或 **`nodescriptions`**：
      - **描述：** 隐藏工具描述，仅显示工具名称。
    - **`schema`**：
      - **描述：** 显示工具配置参数的完整 JSON 模式。
  - **快捷键：** 任意时间按 **Ctrl+T** 切换显示或隐藏工具描述。

- **`/memory`**

  - **描述：** 管理 AI 的指令上下文（从 `GEMINI.md` 文件加载的层次化记忆）。
  - **子命令：**
    - **`add`**：
      - **描述：** 将以下文本添加到 AI 的记忆中。用法：`/memory add <text to remember>`
    - **`show`**：
      - **描述：** 显示从所有 `GEMINI.md` 文件加载的当前层次化记忆的完整拼接内容。这可以让你检查提供给 Gemini 模型的指令上下文。
    - **`refresh`**：
      - **描述：** 从配置位置（全局、项目/父目录和子目录）中找到的所有 `GEMINI.md` 文件重新加载层次化指令记忆。此命令会使用最新的 `GEMINI.md` 内容更新模型。
    - **注意：** 关于 `GEMINI.md` 文件如何构成层次化记忆的更多详情，请参阅 [CLI 配置文档](./configuration.zh.md#4-geminimd-files-hierarchical-instructional-context)。

- **`/restore`**

  - **描述：** 将项目文件恢复到执行工具前的状态。可用于撤销工具造成的文件编辑。如果不带参数运行，会列出可用的检查点。
  - **用法：** `/restore [tool_call_id]`
  - **说明：** 仅在 CLI 使用 `--checkpointing` 选项或在[设置](./configuration.zh.md)中启用时可用。详见[Checkpointing 文档](../checkpointing.zh.md)。

- **`/stats`**

  - **描述：** 显示当前会话的详细统计信息，包括令牌用量、已节省的缓存令牌（如有）和会话持续时间。注意：缓存令牌信息仅在使用 API 密钥身份验证时显示，OAuth 方式目前不支持。

- [**`/theme`**](./themes.zh.md)

  - **描述：** 打开对话框以更改 Gemini CLI 的视觉主题。

- **`/auth`**

  - **描述：** 打开对话框以更改身份验证方式。

- **`/about`**

  - **描述：** 显示版本信息。提交问题时请附带此信息。

- [**`/tools`**](../tools/index.zh.md)

  - **描述：** 显示当前 Gemini CLI 可用工具的列表。
  - **子命令：**
    - **`desc`** 或 **`descriptions`**：
      - **描述：** 显示每个工具的详细描述，包括提供给模型的完整描述。
    - **`nodesc`** 或 **`nodescriptions`**：
      - **描述：** 隐藏工具描述，仅显示工具名称。

- **`/quit`**（或 **`/exit`**）

  - **描述：** 退出 Gemini CLI。

## At 命令 (`@`)

At 命令用于在向 Gemini 提示的过程中包含文件或目录的内容，这些命令支持 git 感知过滤。

- **`@<path_to_file_or_directory>`**

  - **描述：** 将指定文件或文件夹的内容注入到当前提示中。这在查询特定代码、文本或文件集合时非常有用。
  - **示例：**
    - `@path/to/your/file.txt Explain this text.`
    - `@src/my_project/ Summarize the code in this directory.`
    - `What is this file about? @README.md`
  - **详情：**
    - 如果提供单个文件路径，则读取该文件内容。
    - 如果提供目录路径，则尝试读取该目录及子目录下的文件内容。
    - 路径中的空格应使用反斜杠转义（如 `@My\ Documents/file.txt`）。
    - 该命令内部使用 `read_many_files` 工具。内容被获取后插入到查询中再发送给 Gemini 模型。
    - **Git 感知过滤：** 默认情况下，git 忽略的文件（如 `node_modules/`, `dist/`, `.env`, `.git/`）将被排除。此行为可通过 `fileFiltering` 设置更改。
    - **文件类型：** 该命令主要用于文本文件。对于二进制文件或超大文件，底层工具可能跳过或截断以确保性能与相关性，并提示被跳过的文件。
  - **输出：** CLI 将显示工具调用消息，指示已使用 `read_many_files`，并显示处理状态及路径。

- **`@`（单独的 at 符号）**
  - **描述：** 如果你只输入单个 `@`，查询会原样发送给 Gemini 模型。这在你需要在提示中**描述** `@` 符号本身时很有用。

### `@` 命令的错误处理

- 如果 `@` 后指定的路径不存在或无效，会显示错误消息，并且查询可能不会发送给模型，或者会在不包含文件内容的情况下发送。
- 如果 `read_many_files` 工具出现错误（如权限问题），也会报告。

## Shell 模式 & 直通命令 (`!`)

`!` 前缀允许你直接在 Gemini CLI 内与系统 Shell 交互。

- **`!<shell_command>`**

  - **描述：** 在系统默认 Shell 中执行 `<shell_command>`。命令输出或错误会显示在终端。
  - **示例：**
    - `!ls -la`（执行 `ls -la` 并返回 CLI）
    - `!git status`（执行 `git status` 并返回 CLI）

- **`!`（切换 Shell 模式）**

  - **描述：** 单独输入 `!` 可切换 Shell 模式。
    - **进入 Shell 模式：**
      - 激活后，Shell 模式使用不同的配色，并显示"Shell Mode Indicator"。
      - 在 Shell 模式下，你输入的文本将被认为是 Shell 命令。
    - **退出 Shell 模式：**
      - 退出后，UI 恢复为标准外观，Gemini CLI 返回正常行为。

- **所有 `!` 使用的注意事项：** 在 Shell 模式下执行的命令与在终端直接运行具有相同权限和影响，请谨慎操作。